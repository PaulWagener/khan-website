/* TODO(Jason/kamens): this transition animation is just a placeholder, CSS is
 * totally hacked together, needs matching vendor prefixes everywhere, etc
 */
@import "../shared-package/mixins.less";
@import "../shared-package/variables.less";

.stack {
    min-height: 100px;
    margin-bottom: 10px;
}

.current-card-container {
    position: relative;
}

.current-card-container-inner {
    border: 1px solid silver;
    background-color: #F8F8F8;
}

.current-card-container,
.current-card-container-inner {
    .transition(all 0.18s ease-in-out);
}

.current-card.notransition .current-card-container,
.current-card.notransition .current-card-container-inner,
.current-card.shrinkRight .leaves .leaf.earned .full-leaf {
    /* For temporarily disabling transitions.
     * See http://stackoverflow.com/questions/6634470/disable-turn-off-inherited-css3-transitions
     */
    -webkit-transition: none;
    -moz-transition: none;
    -o-transition: color 0 ease-in;
    transition: none;

    -webkit-animation: none;
}

/* TODO(kamens) and TODO(jason): all of these animations are webkit-only atm */
@-webkit-keyframes translate-center-to-ur {
    85% { top: -202px; left: 510px; }
    100% { top: -202px; left: 510px; }
}

@-webkit-keyframes shrink-right-and-fade {
    85% { opacity: 0.15; -webkit-transform: scale(0.1); }
    100% { opacity: 0.0; -webkit-transform: scale(0.1); }
}

.current-card.shrinkRight .current-card-container {
    -webkit-animation: translate-center-to-ur 0.18s ease-in-out 0s 1 forwards normal;
}
.current-card.shrinkRight #extras,
.card-type-endofstack #extras {
    display: none;
}
.current-card.shrinkRight .current-card-container-inner {
    -webkit-animation: shrink-right-and-fade 0.18s ease-in-out 0s 1 forwards normal;
}

.current-card.shrinkLeft .current-card-container {
    left: -510px;
    top: -202px;
}
.current-card.shrinkLeft .current-card-container-inner {
    .scale(0.1);
    .opacity(0);
}

.stack .card {
    width: 25px;
    height: 40px;
    border: 1px solid #bbb;
    margin: 0 auto;

    .transition(all 0.18s ease-in-out);

    .box-shadow(0 0 3px #ccc);
}

.stack .card-container {
    position: relative;
    margin-bottom: -5px;
    z-index: 1;
}

.stack .card .card-face {
    position: absolute;
    width: 25px;
    height: 40px;
}
.stack .card-face.card-front {
    background: #f7f7f7;
}
.stack .card-face.card-back {
    color: white;
    text-align: center;
    background-color: #aaa;
}
.stack .card-face.card-back {
    .box-shadow(inset 0 0 0 2px #fff, inset 0 0 0 4px #cfcfcf);
    background-color: #ccc;
}

.exercises-stack,
.exercises-card {
    float: left;
    width: 5%;

    /* margin-bottom: -9999px;
    padding-bottom: 9999px; */

    .box-sizing(border-box);
}
.exercises-card {
    width: 90%;
}

.current-card {
    position: relative;
}

.current-card #answer_area_wrap {
    margin: 10px -8px 0 0;
}

.current-card #answer_area .info-box {
    overflow: visible;
}
.current-card .info-box:before {
    content: " ";
    display: block;

    border-right: 7px solid transparent;
    border-bottom: 8px solid #ccc;

    width: 0;
    height: 15px;

    position: absolute;
    right: -1px;
    top: -24px;
}

.current-card .exercise_message {
    display: none; /* TODO(kamens/jason): currently hiding all proficient/struggling/review messages */
}

.leaves-container {
    margin: 8px 0 0 15px;
    overflow: visible;
    position: absolute;
    right: 10px;
}
    .card-type-endofstack .leaves-container {
        display: none;
    }

.qtip.ui-tooltip.leaf-tooltip {
    max-width: 200px !important;
}

.current-card .leaves .leaf {
    background: transparent url(/images/power-mode/card-leaf-empty-large.png) no-repeat 50% 0;
    background-size: 40px 40px;
    float: left;
    color: transparent;
    width: 40px;
    height: 40px;
    margin-right: 20px;
}

.stack .leaves .leaf {
    width: 5px;
    height: 5px;
    margin: 2px 0 0 1px;
    float: left;
    background: #83a600;
    color: transparent;
    border: 1px solid #a7b36b;
    position: relative;
    
    line-height: 25px;
    text-align: center;

    .border-radiuses(10px, 50px, 50px, 15px);
    .box-sizing(border-box);
    .box-shadow(inset 0 0 9px 1px rgba(0,0,0,.25));
}

.leaves .leaf.available {
    /* Nothing right now */
}
.leaves .leaf.unavailable {
    background-color: transparent;
    
}
.leaves .leaf.earned .full-leaf {
    background: url(/images/power-mode/card-leaf-full-large.png) no-repeat;
    background-size: 40px 40px;
    .scale(8);
    .opacity(0);
    .transition(all 0.18s ease-in-out);

    width: 40px;
    height: 40px;
    margin: 0 auto;
}

@-webkit-keyframes fly-in-leaf {
    0% { -webkit-transform: scale(8); opacity: 0; }
    66% { -webkit-transform: scale(1); opacity: 0.17; }
    100% { -webkit-transform: scale(1); opacity: 1.0; }
}
.leaves .leaf.earned .full-leaf.animated {
    -webkit-animation: fly-in-leaf 0.3s ease-out 0s 1 forwards normal;
    .scale(1);
    .opacity(1);
}

.stack .leaves .leaf.earned {
    background: #83a600;
    border-color: #5a7300;
    color: transparent;
    box-shadow: none;
}
.stack .leaves .leaf.unavailable {
    .opacity(.5);
}
.stack .leaves .full-leaf {
    display: none;
}

.card-type-endofstack .current-card-contents {
    padding: 20px;
}

.current-card #problemarea {
    margin-top: 35px;
}
.current-card #answer_area_wrap {
    margin-top: 52px;
}

#footer {
    /* 
     * This crazy little sucker invokes a different rendering path
     * for the entire page, even though it's only applied to the footer.
     *
     * This hints to webkit that GPU acceleration should be used where
     * possible, which fixes this annoying bug: http://code.google.com/p/chromium/issues/detail?id=103198
     * as well as any screen flicker on macs when switching to/from GPU
     * rendering.
     *
     * If another fix for this bug is found, this can be removed.
     * See "the magic CSS bullet" here: http://www.html5rocks.com/en/tutorials/speed/html5/#toc-hardware-accell
     *
     * */
    -webkit-transform: translateZ(0);
}

/* End of Stack Card Styling */

.end-of-stack-info .title h1 {
    float: left;
}
.end-of-stack-info .stack-controls .simple-button {
    display: inline-block;
    font-size: 150%;
    text-align: center;
    width: 48%;

    .box-sizing(border-box);
}
.end-of-stack-info .stack-controls .right {
    margin: 0 0 0 2%;
}
.end-of-stack-info .stack-controls .left {
    margin: 0 2% 0 0;
}
.end-of-stack-info .stack-stats {
    float: right;
}
.end-of-stack-info .stack-stats p {
    display: inline-block;
    text-align: center;
    font-size: 150%;
    margin: 0;
    margin-left: 40px;
}

.end-of-stack-info .progress-graph {
    background: white;
    padding: 20px;
    border: 1px solid #CCC;
    margin-bottom: 22px;
}

.end-of-stack-info .progress-graph .skill-bar-title {
    margin: 0;
}

/* Much credit goes to: http://css-tricks.com/css3-progress-bars/ */

.end-of-stack-info .progress-graph .skill-bar {
    margin-bottom: 15px;
    height: 15px;
    padding: 7px;
    position: relative;
    background: #555;

    .border-radius(10px);
    .box-shadow(inset 0 -1px 1px rgba(255,255,255,0.3);
}

.end-of-stack-info .progress-graph .skill-bar .description {
    position: relative;
    color: #fff;
    line-height: 17px; /* This needs to be adjusted if you adjust the skill-bar height */
    padding-left: 10px;
    z-index: 2;
}
.end-of-stack-info .progress-graph .skill-bar .fill {
    display: block;
    height: 100%;
    .border-radius(6px);
    #gradient > .vertical(rgb(43,194,83),rgb(84,240,84));
    .box-shadow(inset 0 2px 9px  rgba(255,255,255,0.3),inset 0 -2px 6px rgba(0,0,0,0.4));
    position: relative;
    overflow: hidden;

    -webkit-animation: progress-bar 2s;
    -moz-animation: progress-bar 2s;
}

.end-of-stack-info .progress-graph .skill-bar.orange .fill {
    #gradient > .vertical(#f1a165,#f36d0a);
}

.end-of-stack-info .progress-graph .skill-bar.red .fill {
    #gradient > .vertical(#f0a3a3,#f42323);
}

/** 
 * Leaving out the "to" or 100% state in these keyframe animations 
 * causes the fill to animate based on the inline width.
 */

@-webkit-keyframes progress-bar {
   0% { width: 0; }
}
@-moz-keyframes progress-bar {
   0% { width: 0; }
}
