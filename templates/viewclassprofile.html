{% extends "profile_template.html" %}

{% import 'macros/coach.html' as coach %}
{% import 'macros/profiles.html' as profile_macros %}

{% block meta_page_title %}Class Profile | {% endblock meta_page_title %}

{% block pagescript %}
{{ js_css_packages.css_package("studentlists") }}
{% raw %}

<script id="profile-student-goals-tmpl" type="text/html">
<div id="class-student-goals">
  <div>Sorted by <span data-bind="text: sort_desc" />. <span data-bind="text: filter_desc" />.</div>
  <div id="class-student-goal" data-bind="foreach: row_data">
    <div data-bind="fastFilter: $parent.fastFilter">
      <div class="student-name"><a data-bind="text: student.nickname, attr: {href: student.profile_url}"></a>
        <span data-bind="visible: student.goal_count > 1 && $parent.show_counts">(<span data-bind="text: goal_idx" />/<span data-bind="text: student.goal_count" />)</span>
        <div data-bind="visible: goal.objectives.length > 0">
          <div class="goal-start-time" data-bind="visible: !$root.show_updated()">Started <span data-bind="text: goal.created_ago"/></div>
          <div class="goal-update-time" data-bind="visible: $root.show_updated()">Updated <span data-bind="text: goal.updated_ago"/></div>
        </div>
      </div>
      <div class="goal">
        <ul class="inline-list objective-list" data-bind="foreach: goal.objectives">
          <li data-bind="style: {width: (100/$parent.goal.objectives.length)+'%'}"><a class="objective simple-button action-gradient exercise-color seethrough" data-bind="goalObjectiveCSS: $data, fastFilter: $root.fastFilterCSS, click: click_fn, text: description"></a></li>
        </ul>
      </div>
    </div>
  </div>
</div>
</script>

{% endraw %}
{% endblock pagescript %}

{% block pagesubmenu %}
<span class="breadcrumbs_nav">
    <a href="/coaches" id="manage-coaches">Manage Coaches</a>
    <a href="/students" id="manage-students">Manage Students</a>
    <a href="/class_profile" id="class-stats" class="selected">Class Stats For</a>
    <span id="studentlists_dropdown" style="display:none;">
        <a>{{ student_list.name|escape }}</a>
        <div id="studentlists_menu">
            <ol>
                {% for list in student_lists %}
                <li data-selected="{% if list.key == list_id %}selected{% endif %}" data-list_id={{ list.key }}>
                    <a href="/class_profile?list_id={{ list.key }}">{{list.name|escape}}</a>
                </li>
                {% endfor %}
            </ol>
        </div>
    </span>
</span>
{% endblock pagesubmenu %}

{% block statistics_title %}Class Statistics{% endblock statistics_title %}

{% block graph_accordion %}
<div id="high-level-class-stats">
    <span id="students-coached">
        <span class="profile-header-icon"><img src="/images/class-students-icon-shadow.png" /></span>
        <span class="count">
            <span id="count_students">&hellip;</span><br />
            <span class="label">Students</span>
        </span>
    </span>
    <span id="energy-points">
        <span class="energy-points-badge">&hellip;</span><br />
        <span class="label">Class Energy Points</span>
    </span>
</div>

    <ul id="nav-accordion">
        <li>
            {{ profile_macros.class_api_link(user_data_coach, "Progress Report", "user/students/progressreport", selected_graph_type, list_id) }}
            <div class="accordion-content">
                Shows you which exercises your class has worked on and completed.
                <div class="graph-options">
                    <span class="progress-legend exercise-color started">Started</span>                
                    <span class="progress-legend exercise-color proficient">Proficient</span>
                    <span class="progress-legend exercise-color review light">Review</span>
                    <span class="progress-legend exercise-color struggling">Struggling</span>

                    <div class="coach-option-block">
                      <div>Filter by:</div>
                      <div>
                        <span class="coach-filter-block"><input type="checkbox" class="progressreport-filter-check" name="struggling" />Struggling only</span>
                        <span class="coach-filter-block"><input type="checkbox" class="progressreport-filter-check" name="recent" />Worked on in last: 
                            <select id="progressreport-filter-last-time"><option value="1">day</option><option value="2">2 days</option><option value="3">3 days</option><option selected value="7">week</option><option value="30">month</option></select></span>
                      </div>
                    </div>
                    <div class="coach-option-block">
                      <div>Filter by student or exercise:</div>
                      <div>
                        <input type="text" id="student-progressreport-search"></input>
                      </div>
                    </div>
                </div>
            </div>
        </li>
        <li>
            {{ profile_macros.class_graph_link(user_data_coach, "Daily Activity Report", "classtime", selected_graph_type, list_id) }}
            <p class="accordion-content">
                Shows your total class activity on a specific date.
                {{ profile_macros.graph_calendar_picker(user_data_coach, "classtime") }}
                <span class="instructions">Light blue activity shows normal school hours, and dark blue is outside normal hours.</span>
            </p>
        </li>
        <li>
            {{ profile_macros.class_graph_link(user_data_coach, "Exercise Progress Over Time", "classexercisesovertime", selected_graph_type, list_id) }}
            <div class="accordion-content">Shows how many exercises your students have completed over time.<br /><br />
                <span class="instructions">Highlight a <a href="#" class="highlight-section show-students-highlight">specific student</a> or a <a href="#" class="highlight-section show-exercises-highlight">specific exercise</a>.</span><br />

                <div id="students-highlight" class="vertical-choice-container" style="display:none;">
                    <ul>
                        <li>&hellip;</li>
                    </ul>
                </div>

                <div id="exercises-highlight" class="vertical-choice-container" style="display:none;">
                    <ul>
                        {% for exercise in exercises %}
                        <li>
                        <a href="#" class="highlight-exercise-points" data-exercise="{{ exercise.name|escape }}">{{ exercise.display_name|escape }}</a>
                        </li>
                        {% endfor %}
                    </ul>
                </div>

            </div>
        </li>
        <li>
            {{ profile_macros.class_graph_link(user_data_coach, "Class Points per Minute", "classenergypointsperminute", selected_graph_type, list_id) }}
            <p class="accordion-content">
                Shows your total class energy points per minute as a continuously updating rolling average.
            </p>
        </li>
        <li>
            {{ profile_macros.class_api_link(user_data_coach, "Goals", "user/students/goals", selected_graph_type, list_id) }}
            <div class="accordion-content">
                Shows active student goals and progress toward completion of those goals.
                <div class="graph-options">
                    <span class="progress-legend exercise-color started">Started</span>                
                    <span class="progress-legend exercise-color proficient">Proficient</span>
                    <span class="progress-legend exercise-color review light">Review</span>
                    <span class="progress-legend exercise-color struggling">Struggling</span>
                    <div id="student-goals-sort-block">
                      <div>Sort by:</div>
                      <div><select id="student-goals-sort"><option value="name">Name</option><option value="progress">Progress</option><option value="created">Start date</option><option value="updated">Updated date</option></select></div>
                    </div>
                    <div id="student-goals-filter-block">
                      <div>Filter by:</div>
                      <div>
                        <span class="coach-filter-block"><input type="checkbox" class="student-goals-filter-check" name="most-recent" />Recently updated only</span>
                        <span class="coach-filter-block"><input type="checkbox" class="student-goals-filter-check" name="in-progress" />In progress only</span>
                        <span class="coach-filter-block"><input type="checkbox" class="student-goals-filter-check" name="struggling" />Struggling only</span>
                      </div>
                    </div>
                    <div id="student-goals-search-block">
                      <div>Filter by student or objective:</div>
                      <div>
                        <input type="text" id="student-goals-search"></input>
                      </div>
                    </div>
                </div>
            </div>
        </li>
    </ul>
{% endblock graph_accordion %}

{% block profile_is_empty %}
{{ coach.empty_class_instructions(True) }}
{% endblock profile_is_empty %}

{% block bottompagescript %}
{{ super() }}
{{ js_css_packages.js_package("studentlists") }}
<script type="text/javascript">
$(function() {
    ClassProfile.student_lists = {{student_lists_json}};
    ClassProfile.init();
})
</script>
{% endblock bottompagescript %}
